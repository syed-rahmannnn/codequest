<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CodeQuest - Start</title>
  <link rel="stylesheet" href="style.css">
</head>
<script>
  const username = prompt("Enter your name:");
  if (username) {
    localStorage.setItem("currentUser", username.toLowerCase());
  } else {
    alert("Username is required to start the game.");
    location.reload(); // force prompt again
  }
</script>

<body>
  <nav class="navbar">
    <div class="nav-container">
      <span class="logo">CodeQuest</span>
      <button class="hamburger" onclick="toggleMenu()">‚ò∞</button>
      <ul class="nav-links" id="navLinks">
        <li><a class="nav-item active" href="#html" data-topic="html">HTML</a></li>
        <li><a class="nav-item" href="#css" data-topic="css">CSS</a></li>
        <li><a class="nav-item" href="#js" data-topic="js">javascript</a></li>
        <li><a class="nav-item" href="#python" data-topic="python">python</a></li>
      </ul>
    </div>
  </nav>

  <div class="start-screen">
    <p class="score">üèÜ <span id="userName">User</span>'s Score: <span id="scoreValue">0</span></p>
    <h1 class="typewriter">Welcome to CodeQuest</h1>
    <button onclick="startGame()">Start Adventure</button>
    <button onclick="showDashboard()">View Dashboard</button>
  </div>
  <div id="dashboard" style="display:none; margin-top: 20px;">
    <h2>üèÖ Score Dashboard</h2>
    <table border="1" style="width: 100%; text-align: left;">
      <thead>
        <tr>
          <th>Username</th>
          <th>Score</th>
        </tr>
      </thead>
      <tbody id="dashboardBody">
        <!-- Filled dynamically -->
      </tbody>
    </table>
    <button onclick="hideDashboard()">Hide Dashboard</button>
  </div>
  <script>
    function toggleMenu() {
      document.getElementById("navLinks").classList.toggle("open");
    }
  </script>
  <script>
    function getCurrentUsername() {
        return localStorage.getItem("currentUser") || "guest";
    }

    function getScoresObject() {
        return JSON.parse(localStorage.getItem("userScores") || "{}");
    }

    function getUserScore(username) {
        const scores = getScoresObject();
        return scores[username] || 0;
    }

    function updateScoreDisplay() {
        const username = getCurrentUsername();
        document.getElementById("userName").textContent = username;
        document.getElementById("scoreValue").textContent = getUserScore(username);
    }

    // Call this on page load
    updateScoreDisplay();
    function showDashboard() {
      const dashboard = document.getElementById("dashboard");
      const dashboardBody = document.getElementById("dashboardBody");
      const scores = getScoresObject();

      // Clear old rows
      dashboardBody.innerHTML = "";

      const sortedEntries = Object.entries(scores).sort((a, b) => b[1] - a[1]); // sort by score descending

      for (const [user, score] of sortedEntries) {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${user}</td><td>${score}</td>`;
        dashboardBody.appendChild(row);
      }

      dashboard.style.display = "block";
    }

  function hideDashboard() {
    document.getElementById("dashboard").style.display = "none";
  }
  </script>
  <script>
    // ‚úÖ Declare globally
    let selectedTopic = "html"; // default

    // ‚úÖ Toggle mobile menu
    function toggleMenu() {
      document.getElementById("navLinks").classList.toggle("open");
    }

    // ‚úÖ Run when DOM is ready
    document.addEventListener("DOMContentLoaded", function () {
      // Initialize selectedTopic from active item
      const activeTab = document.querySelector(".nav-item.active");
      if (activeTab) {
        selectedTopic = activeTab.dataset.topic;
      }

      // Set up navbar click events
      document.querySelectorAll(".nav-item").forEach(item => {
        item.addEventListener("click", function (e) {
          e.preventDefault();

          // Remove active from all
          document.querySelectorAll(".nav-item").forEach(el => el.classList.remove("active"));

          // Set active and selected topic
          this.classList.add("active");
          selectedTopic = this.dataset.topic;

          // Optional: update URL fragment
          window.history.replaceState(null, "", `#${selectedTopic}`);
        });
      });
    });

    // ‚úÖ Called on button click
    function startGame() {
      const levelPage = `${selectedTopic}level-1.html`;
      console.log("Redirecting to:", levelPage); // Dev message
      window.location.href = levelPage;
    }
  </script>
</body>
</html>
